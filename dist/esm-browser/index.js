!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("rxjs"),require("qrcode-generator"),require("axios"),require("uuid"),require("rxjs/operators"),require("js-base64"));else if("function"==typeof define&&define.amd)define(["rxjs","qrcode-generator","axios","uuid","rxjs/operators","js-base64"],t);else{var n="object"==typeof exports?t(require("rxjs"),require("qrcode-generator"),require("axios"),require("uuid"),require("rxjs/operators"),require("js-base64")):t(e.rxjs,e["qrcode-generator"],e.axios,e.uuid,e["rxjs/operators"],e["js-base64"]);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,((__WEBPACK_EXTERNAL_MODULE__832__,__WEBPACK_EXTERNAL_MODULE__139__,__WEBPACK_EXTERNAL_MODULE__300__,__WEBPACK_EXTERNAL_MODULE__459__,__WEBPACK_EXTERNAL_MODULE__597__,__WEBPACK_EXTERNAL_MODULE__594__)=>(()=>{var __webpack_modules__={413:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SupportContentType=t.FileType=void 0,function(e){e.Audio="audio/*",e.Video="video/*",e.HTML="text/html",e.Txt="text/plain",e.Image="image/*",e.Csv=".csv",e.Pdf="application/pdf",e.Word="application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/msword，application/vnd.openxmlformats-officedocument.wordprocessingml.document",e.All="*"}(t.FileType||(t.FileType={})),function(e){e.JSON="application/json",e.TEXT="text/plain"}(t.SupportContentType||(t.SupportContentType={}))},68:()=>{},558:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(675),o=n(982),i=n(302),s=n(263),u=n(124);n(68);const a=new(0,(0,r.PlatformSelect)({web:{pc:u.PCWebBridge,mobile:s.MobileWebBridge},node:{pc:i.PCNodejsBridge,mobile:o.MobileNodejsBridge},electron:{}})[r.isElectron?"electron":r.isPC?"pc":"mobile"]);t.default=a},206:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlatformBridge=void 0;const rxjs_1=__webpack_require__(832),ObjectAble_1=__webpack_require__(508),QRCode=__webpack_require__(139),axios_1=__webpack_require__(300),Hardware_1=__webpack_require__(870);class PlatformBridge extends Hardware_1.HardwareBase{createQrCode(e,t){return new rxjs_1.Observable((n=>{let r=t?.SideLength??200;const o=QRCode(t?.type||4,t?.Level||"H");o.addData(e??""),o.make();const i=(r-4)/o.getModuleCount(),s=o.createDataURL(i,2);return n.next(new ObjectAble_1.StringObject(s)),n.complete(),{unsubscribe:()=>n.unsubscribe()}}))}loadRunInfo(){throw new Error("Method not implemented.")}runCommand(command,option){return new rxjs_1.Observable((subscriber=>{let result=null,error=null,status=!1;try{result=eval(command?.toString()),status=!0}catch(e){error=e,status=!1}finally{subscriber.next({result,status,error,command}),subscriber.complete()}return{unsubscribe:()=>subscriber.unsubscribe()}}))}open(e,t){throw new Error("Method not implemented.")}loadFile(e,t){throw new Error("Method not implemented.")}fetch(e){return new rxjs_1.Observable((t=>(axios_1.default.request(e).then((e=>{let n=null,r=null;const o={};200!==e.status?n=new Error(`${e.status} ${e.statusText}`):r=e.data,o.data=r,o.error=n,o.response=e,t.next(new ObjectAble_1.ObjectTarget(o)),t.complete()})).catch((e=>{t.error(e)})),{unsubscribe:()=>{t.unsubscribe()}})))}}exports.PlatformBridge=PlatformBridge},870:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HardwareBase=void 0;t.HardwareBase=class{takePhoto(e){throw new Error("Method not implemented.")}recordVideo(e){throw new Error("Method not implemented.")}getPhotos(){throw new Error("Method not implemented.")}getCurrentPosition(){throw new Error("Method not implemented.")}watchPosition(e){throw new Error("Method not implemented.")}closePosition(){throw new Error("Method not implemented.")}recordAudio(){throw new Error("Method not implemented.")}stopAudio(){throw new Error("Method not implemented.")}getFile(e){throw new Error("Method not implemented.")}startVibrator(e){throw new Error("Method not implemented.")}stopVibrator(){throw new Error("Method not implemented.")}getSystemInfo(){throw new Error("Method not implemented.")}getVolume(){throw new Error("Method not implemented.")}setVolume(e){throw new Error("Method not implemented.")}getBrightness(){throw new Error("Method not implemented.")}setBrightness(e){throw new Error("Method not implemented.")}scanBluetooth(){throw new Error("Method not implemented.")}connectBluetooth(e){throw new Error("Method not implemented.")}bluetoothSendData(e){throw new Error("Method not implemented.")}bluetoothReceiveData(e){throw new Error("Method not implemented.")}bluetoothClose(e){throw new Error("Method not implemented.")}speechInit(e){throw new Error("Method not implemented.")}speak(e){throw new Error("Method not implemented.")}stopSpeak(){throw new Error("Method not implemented.")}clearSpeech(){throw new Error("Method not implemented.")}}},982:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileNodejsBridge=void 0;const r=n(832),o=n(508),i=n(206);class s extends i.PlatformBridge{open(e){return(0,r.of)(new o.BooleanObject(!1))}loadFile(e,t){return(0,r.of)(new o.ObjectTarget({total:0,loaded:0,data:new ArrayBuffer(0),finish:!0,file:null}))}}t.MobileNodejsBridge=s},302:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PCNodejsBridge=void 0;const r=n(206);class o extends r.PlatformBridge{}t.PCNodejsBridge=o},263:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileWebBridge=void 0;const r=n(796);class o extends r.WebBridge{}t.MobileWebBridge=o},124:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PCWebBridge=void 0;const r=n(796);class o extends r.WebBridge{}t.PCWebBridge=o},796:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebBridge=void 0;const r=n(832),o=n(508),i=n(206);class s extends i.PlatformBridge{open(e){const t=window.open(e,"__blank");return(0,r.of)(new o.BooleanObject(null!==t))}loadFile(e,t){return new r.Observable((e=>{const n=document.createElement("input");return n.type="file",n.id="_temp_input_select",n.accept=t?.type||"*",n.style.display="none",document.body.append(n),n.addEventListener("change",(t=>{const r=new FileReader,i=n.files[0];r.onprogress=t=>{const{total:n,loaded:s}=t,u=r.result;e.next(new o.ObjectTarget({total:n,loaded:s,data:u,finish:!1,file:i}))},r.onload=t=>{const n=r.result,{total:s,loaded:u}=t;e.next(new o.ObjectTarget({total:s,loaded:u,data:n,finish:!0,file:i})),e.complete()},r.onerror=t=>{e.error(t)},r.readAsArrayBuffer(i)})),n.click(),{unsubscribe:()=>e.unsubscribe()}}))}}t.WebBridge=s},783:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultRunConfig=void 0;const r=n(413);t.DefaultRunConfig={development:!0,environment:{},workConfig:{QRCodeWork:{type:4,Level:"H",SideLength:100},RunCommandWork:{input:"$I$"},LoadFileWork:{type:r.FileType.All},FetchWork:{headers:{"Access-Control-Allow-Origin":"*"}}}}},983:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;const r=n(398),o=n(832),i=n(783),s=n(508),u=n(558),a=n(992),c=n(652),l=n(597);t.Context=class{constructor(e){this.status=r.WorkType.WorkRunStatus.INIT,this.platform=u.default,this.runConstant=new Map,this.works=[],this.msgChannel=new o.Subject,this.pools=[],this.runOptions=e||i.DefaultRunConfig;const t=this.msgChannel.subscribe({next:e=>this.workMessage(e),error:e=>this.workError(e)});this.pools.push(t),this.addWork(new a.BeginWork)}addVariable(e,t,n){!this.runConstant.get(e.uuid)&&this.runConstant.set(e.uuid,new Map),this.runConstant.get(e.uuid).set(t,n)}workMessage(e){console.log("msgChannel",e)}workError(e){console.log("msgChannelError",e),this.stopWorkChain()}addWorkLog(e){return this.msgChannel.subscribe(e)}sendLog(e){const t={date:new Date,work:e.work.filter((e=>e?.name)),desc:e.desc,value:e.value,error:e.error};this.msgChannel.next(t)}addWork(e){if(e.constructor.isAble&&!1===e.constructor.isAble()){const e="[content][Func:addWork][work isAble is false]";return this.sendLog({content:this,work:[],desc:e,value:null,error:new Error(e)})}if(this.status!==r.WorkType.WorkRunStatus.INIT)return this.sendLog({content:this,work:[],desc:"[content][Func:addWork][context status is not init]",value:new s.BooleanObject(!1)});e.context=this,this.works.push(e)}addWorks(...e){e.forEach(this.addWork)}async prepareWorks(){if(this.status!==r.WorkType.WorkRunStatus.INIT)return this.sendLog({content:this,work:[],desc:"[content][Func:prepareWorks][context status is not init]",value:new s.BooleanObject(!1)});await Promise.all(this.works.map(((e,t,n)=>{const r=n[t-1],o=n[t+1];return e.prepare(r,o)}))),this.status=r.WorkType.WorkRunStatus.READY}dispatch(e){if(this.status===r.WorkType.WorkRunStatus.INIT)return this.sendLog({content:this,work:[],desc:"[context][Func:run][run status is not ready  or 已经初始化]",value:new s.BooleanObject(!1)});const t=this.works[0];t&&t.startRun((0,c.decide)(e)),this.status=r.WorkType.WorkRunStatus.RUNNING}stopWorkChain(){const e=this;return new Promise(((t,n)=>{const r=this.works.map((e=>e.stopWork()));let i=!1,u=[];(0,o.forkJoin)(r).pipe((0,l.take)(1)).subscribe({next:e=>{i=e.every(((e,t)=>!0===e||(u.push(this.works[t]),!1))),t(i)},error:e=>{n(e)},complete:()=>{this.sendLog({content:e,work:u,desc:"[content][Func:stopWorkChain]",value:new s.ObjectTarget({id:"stopWorkChain",value:(0,c.decide)(i),option:{}})})}})}))}clear(){this.pools.forEach((e=>e.unsubscribe()))}}},508:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataObject=t.DateObject=t.BooleanObject=t.StringObject=t.NumberObject=t.SetObject=t.MapObject=t.ArrayObject=t.ObjectTarget=void 0;const r=n(758);Object.defineProperty(t,"ObjectTarget",{enumerable:!0,get:function(){return r.ObjectTarget}});const o=n(327);Object.defineProperty(t,"ArrayObject",{enumerable:!0,get:function(){return o.ArrayObject}});const i=n(175);Object.defineProperty(t,"MapObject",{enumerable:!0,get:function(){return i.MapObject}});const s=n(49);Object.defineProperty(t,"SetObject",{enumerable:!0,get:function(){return s.SetObject}});const u=n(723);Object.defineProperty(t,"NumberObject",{enumerable:!0,get:function(){return u.NumberObject}});const a=n(93);Object.defineProperty(t,"StringObject",{enumerable:!0,get:function(){return a.StringObject}});const c=n(973);Object.defineProperty(t,"BooleanObject",{enumerable:!0,get:function(){return c.BooleanObject}});const l=n(612);Object.defineProperty(t,"DateObject",{enumerable:!0,get:function(){return l.DateObject}});const p=n(976);Object.defineProperty(t,"DataObject",{enumerable:!0,get:function(){return p.DataObject}})},327:function(e,t,n){"use strict";var r,o=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayObject=void 0;n(400);const u=n(388),a=n(758),c=n(652);let l=r=class extends a.ObjectTarget{constructor(e){var t="number"==typeof e?new Array(e):Array.isArray(e)?e:[];super(t),this._value=t}len(){return this._value.length}first(){return this[0]}last(){return this[this._value.length-1]}valueOfIndex(e){return this[e]}valueOf(){return this._value}merge(e){return new r([...this._value,...e._value])}collectionArray(e,...t){return null}concat(...e){return null}copyWithin(e,t,n){return null}fill(e,t,n){return null}find(e,t){return null}findIndex(e,t){return null}lastIndexOf(e,t){return null}pop(){return null}push(...e){return null}reverse(){return null}shift(){return null}unshift(...e){return null}slice(e,t){return null}sort(e){return null}splice(e,t,...n){return null}includes(e,t){return null}indexOf(e,t){return null}join(e){return null}entries(){return null}values(){return null}keys(){return null}forEach(e,t){return null}filter(e,t){return null}map(e,t){return null}every(e,t){return null}some(e,t){return null}reduce(e,t){return null}reduceRight(e,t){return null}toLocaleString(){return null}get length(){return(0,c.decide)(this._value.length)}};l.attributes=new Set,l.empty=new r([]),o([(0,u.attribute)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Number)],l.prototype,"len",null),o([(0,u.attribute)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],l.prototype,"first",null),o([(0,u.attribute)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],l.prototype,"last",null),o([(0,u.attribute)(),s(0,(0,u.Params)("index")),i("design:type",Function),i("design:paramtypes",[Number]),i("design:returntype",Object)],l.prototype,"valueOfIndex",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[String,Object]),i("design:returntype",Object)],l.prototype,"collectionArray",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],l.prototype,"concat",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Number,Number,Number]),i("design:returntype",Object)],l.prototype,"copyWithin",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Number,Number,Number]),i("design:returntype",Object)],l.prototype,"fill",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function,Object]),i("design:returntype",Object)],l.prototype,"find",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function,Object]),i("design:returntype",Object)],l.prototype,"findIndex",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Number,Number]),i("design:returntype",Object)],l.prototype,"lastIndexOf",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],l.prototype,"pop",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],l.prototype,"push",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],l.prototype,"reverse",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],l.prototype,"shift",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],l.prototype,"unshift",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Number,Number]),i("design:returntype",Object)],l.prototype,"slice",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function]),i("design:returntype",Object)],l.prototype,"sort",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Number,Number,Object]),i("design:returntype",Object)],l.prototype,"splice",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Object,Number]),i("design:returntype",Object)],l.prototype,"includes",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Object,Number]),i("design:returntype",Object)],l.prototype,"indexOf",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[String]),i("design:returntype",Object)],l.prototype,"join",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",a.ObjectTarget)],l.prototype,"entries",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",a.ObjectTarget)],l.prototype,"values",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",a.ObjectTarget)],l.prototype,"keys",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function,Object]),i("design:returntype",Object)],l.prototype,"forEach",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function,Object]),i("design:returntype",Object)],l.prototype,"filter",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function,Object]),i("design:returntype",Object)],l.prototype,"map",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function,Object]),i("design:returntype",Object)],l.prototype,"every",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function,Object]),i("design:returntype",Object)],l.prototype,"some",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function,Object]),i("design:returntype",Object)],l.prototype,"reduce",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function,Object]),i("design:returntype",Object)],l.prototype,"reduceRight",null),o([u.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],l.prototype,"toLocaleString",null),o([(0,u.DefaultValue)(Object.prototype.toString.call([])),i("design:type",String)],l,"type",void 0),l=r=o([u.ArrayUint,i("design:paramtypes",[Object])],l),t.ArrayObject=l},973:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.BooleanObject=void 0;const i=n(388),s=n(758);class u extends s.ObjectTarget{constructor(e=!1){super(e),this._value=e}valueOf(){return!!this._value}}u.attributes=new Set,u.empty=new u(!1),r([(0,i.attribute)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Boolean)],u.prototype,"valueOf",null),r([(0,i.DefaultValue)(Object.prototype.toString.call(new Boolean(1))),o("design:type",String)],u,"type",void 0),t.BooleanObject=u},976:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DataObject=void 0;const i=n(388),s=n(758);class u extends s.ObjectTarget{constructor(e=new ArrayBuffer(0)){super(e),this._value=e}data(){return this.valueOf()}valueOf(){return this._value}}u.attributes=new Set,u.empty=new u(new ArrayBuffer(0)),r([(0,i.attribute)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",ArrayBuffer)],u.prototype,"valueOf",null),t.DataObject=u},612:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DateObject=void 0;const i=n(388),s=n(758);class u extends s.ObjectTarget{constructor(e=new Date){super(e),this._value=e}timestamp(){return this.valueOf().getTime()}valueOf(){return new Date(this._value)}}u.attributes=new Set,u.empty=new u(new Date),r([(0,i.attribute)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Number)],u.prototype,"timestamp",null),r([(0,i.attribute)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Date)],u.prototype,"valueOf",null),r([(0,i.DefaultValue)(Object.prototype.toString.call(new Date)),o("design:type",String)],u,"type",void 0),t.DateObject=u},175:function(e,t,n){"use strict";var r,o=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.MapObject=void 0;n(400);const s=n(388),u=n(758),a=n(652);let c=r=class extends u.ObjectTarget{constructor(e=new Map){super(e),this._value=new Map(e)}len(){return this._value.size}valueOf(){return this._value}merge(e){const t=new Map(this._value);return e._value.forEach(((e,n)=>t.set(n,e))),new r(t)}collectionMap(e,...t){return null}get(e){return null}set(e,t){return null}has(e){return null}delete(e){return null}clear(){return null}entries(){return null}forEach(e,t){return null}values(){return null}keys(){return null}get size(){return(0,a.decide)(this._value.size)}};c.attributes=new Set,c.empty=new r(new Map),o([(0,s.attribute)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Number)],c.prototype,"len",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[String,Object]),i("design:returntype",Object)],c.prototype,"collectionMap",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[String]),i("design:returntype",Object)],c.prototype,"get",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[String,Object]),i("design:returntype",Object)],c.prototype,"set",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[String]),i("design:returntype",Object)],c.prototype,"has",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[String]),i("design:returntype",Object)],c.prototype,"delete",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],c.prototype,"clear",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],c.prototype,"entries",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function,Object]),i("design:returntype",Object)],c.prototype,"forEach",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],c.prototype,"values",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],c.prototype,"keys",null),o([(0,s.DefaultValue)(Object.prototype.toString.call(new Map)),i("design:type",String)],c,"type",void 0),c=r=o([s.MapUint,i("design:paramtypes",[Map])],c),t.MapObject=c},723:function(e,t,n){"use strict";var r,o=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.NumberObject=void 0;const s=n(388),u=n(758),a=n(973);let c=r=class extends u.ObjectTarget{constructor(e=1){super(e),this._value=e}valueOf(){return this._value}merge(e){return new r(this._value+e._value)}more(e){return new a.BooleanObject(this._value>e._value)}equal(e){return new a.BooleanObject(this._value===e._value)}less(e){return new a.BooleanObject(this._value<e._value)}moreEqual(e){return new a.BooleanObject(this._value>=e._value)}lessEqual(e){return new a.BooleanObject(this._value<=e._value)}plus(e){return new r(this._value+e._value)}reduce(e){return new r(this._value-e._value)}multi(e){return new r(this._value*e._value)}divide(e){return new r(0===e._value?1/0:this._value/e._value)}};c.attributes=new Set,c.empty=new r(0),o([(0,s.attribute)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Number)],c.prototype,"valueOf",null),o([(0,s.DefaultValue)(Object.prototype.toString.call(new Number)),i("design:type",String)],c,"type",void 0),c=r=o([s.CalcUnit,s.CompareUnit,i("design:paramtypes",[Number])],c),t.NumberObject=c},758:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectTarget=void 0;const i=n(388);class s{constructor(e={}){this._value=e}get[Symbol.toStringTag](){return"flow-object"}valueOf(){return this._value}merge(e){try{const t=Object.assign(this._value,e._value);return new s(t)}catch(e){return new s(null)}}json(){const{StringObject:e}=n(93);try{return new e(JSON.stringify(this._value))}catch(t){return new e("{}")}}}s.attributes=new Set,s.empty=new s({}),r([(0,i.DefaultValue)(Object.prototype.toString.call({})),o("design:type",String)],s,"type",void 0),t.ObjectTarget=s},49:function(e,t,n){"use strict";var r,o=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SetObject=void 0;n(400);const s=n(388),u=n(758),a=n(652);let c=r=class extends u.ObjectTarget{constructor(e){const t=e?Array.isArray(e)?new Set(e):e:new Set;super(t),this._value=t}len(){return this._value.size}valueOf(){return this._value}merge(e){const t=new Set;return this._value.forEach((e=>t.add(e))),e.forEach((e=>t.add(e))),(new Set).keys,new r(t)}collectionSet(e,...t){return null}has(e){return null}add(e){return null}delete(e){return null}clear(){return null}forEach(e,t){return null}entries(){return null}values(){return null}keys(){return null}get size(){return(0,a.decide)(this._value.size)}};c.attributes=new Set,c.empty=new r(new Set),o([(0,s.attribute)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Number)],c.prototype,"len",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[String,Object]),i("design:returntype",Object)],c.prototype,"collectionSet",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],c.prototype,"has",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],c.prototype,"add",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Object)],c.prototype,"delete",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],c.prototype,"clear",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[Function,Object]),i("design:returntype",Object)],c.prototype,"forEach",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",u.ObjectTarget)],c.prototype,"entries",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",u.ObjectTarget)],c.prototype,"values",null),o([s.onlyDeclaration,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",u.ObjectTarget)],c.prototype,"keys",null),o([(0,s.DefaultValue)(Object.prototype.toString.call(new Set)),i("design:type",String)],c,"type",void 0),c=r=o([s.SetUint,i("design:paramtypes",[Object])],c),t.SetObject=c},93:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.StringObject=void 0;const i=n(388),s=n(758);class u extends s.ObjectTarget{constructor(e=""){super(e),this._value=e}valueOf(){return this._value}}u.attributes=new Set,u.empty=new u(""),r([(0,i.attribute)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",String)],u.prototype,"valueOf",null),r([(0,i.DefaultValue)(Object.prototype.toString.call(new String)),o("design:type",String)],u,"type",void 0),t.StringObject=u},400:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ControlFlow=void 0,function(e){let t,n,r,o,i,s;!function(e){e.More="more",e.Equal="equal",e.Less="less",e.MoreEqual="moreEqual",e.LessEqual="lessEqual"}(t=e.CompareEnum||(e.CompareEnum={})),function(e){e.Plus="plus",e.Reduce="reduce",e.Multi="multi",e.Divide="divide"}(n=e.CalcEnum||(e.CalcEnum={})),function(e){e.Contain="contain",e.Add="add",e.ValueFor="valueFor",e.Keys="keys",e.Values="values"}(r=e.CollectionEnum||(e.CollectionEnum={})),function(e){e.Concat="concat",e.CopyWithin="copyWithin",e.Fill="fill",e.Find="find",e.FindIndex="findIndex",e.LastIndexOf="lastIndexOf",e.Pop="pop",e.Push="push",e.Reverse="reverse",e.Shift="shift",e.Unshift="unshift",e.Slice="slice",e.Sort="sort",e.Splice="splice",e.Includes="includes",e.IndexOf="indexOf",e.Join="join",e.Keys="keys",e.Entries="entries",e.Values="values",e.ForEach="forEach",e.Filter="filter",e.Map="map",e.Every="every",e.Some="some",e.Reduce="reduce",e.ReduceRight="reduceRight"}(o=e.ArrayEnum||(e.ArrayEnum={})),function(e){e.Has="has",e.Add="add",e.Delete="delete",e.Clear="clear",e.Entries="entries",e.ForEach="forEach",e.Values="values",e.Keys="keys"}(i=e.SetEnum||(e.SetEnum={})),function(e){e.Get="get",e.Set="set",e.Has="has",e.Delete="delete",e.Clear="clear",e.Entries="entries",e.ForEach="forEach",e.Keys="keys",e.Values="values"}(s=e.MapEnum||(e.MapEnum={}))}(t.ControlFlow||(t.ControlFlow={}))},388:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapUint=t.SetUint=t.ArrayUint=t.CalcUnit=t.CompareUnit=t.onlyDeclaration=t.DefaultValue=t.ObjectManager=t.Params=t.attribute=t.onlyDeclarationTag=void 0;const r=n(508),o=n(400),i=n(652);t.onlyDeclarationTag="onlyDeclaration",t.attribute=function(){return function(e,t,n){e.constructor.attributes.add(t)}},t.Params=function(e){return function(t,n,r){!t.$Meta&&(t.$Meta={}),!t.$Meta[n]&&(t.$Meta[n]={}),t.$Meta[n][r]=e}};class s{}t.ObjectManager=s,s.types=new Set,t.DefaultValue=function(e){return function(t,n){t[n]=e,s.types.add(e)}},t.onlyDeclaration=function(e,n,r){r.value.declaration=t.onlyDeclarationTag},t.CompareUnit=function(e){Object.keys(o.ControlFlow.CompareEnum).forEach((n=>{const i=o.ControlFlow.CompareEnum[n],s=e.prototype[i];s&&s.declaration!==t.onlyDeclarationTag||(e.prototype[i]=()=>new r.BooleanObject(!1))})),e.prototype.compare?.declaration!==t.onlyDeclarationTag&&!1!=!!e.prototype.compare||(e.prototype.compare=function(t,n){const r=e.prototype[t]?.bind(this);return!(!r||"function"!=typeof r)&&r.call(this,n)})},t.CalcUnit=function(e){Object.keys(o.ControlFlow.CalcEnum).forEach((n=>{const i=o.ControlFlow.CalcEnum[n],s=e.prototype[i];s&&s.declaration!==t.onlyDeclarationTag||(e.prototype[i]=()=>new r.NumberObject(0))})),e.prototype.calc?.declaration!==t.onlyDeclarationTag&&!1!=!!e.prototype.calc||(e.prototype.calc=function(t,n){const r=e.prototype[t]?.bind(this);return!(!r||"function"!=typeof r)&&r.call(this,n)})},t.ArrayUint=function(e){Object.keys(o.ControlFlow.ArrayEnum).forEach((n=>{const r=o.ControlFlow.ArrayEnum[n],s=e.prototype[r];s&&s.declaration!==t.onlyDeclarationTag||(e.prototype[r]=function(...e){const t=this.valueOf(),n=t[r];let o;return o="function"==typeof n?n.bind(t)(...e):t,(0,i.decide)(o)})})),e.prototype.collectionArray?.declaration!==t.onlyDeclarationTag&&!1!=!!e.prototype.collectionArray||(e.prototype.collectionArray=function(t,...n){const r=e.prototype[t]?.bind(this);return!(!r||"function"!=typeof r)&&r(...n)})},t.SetUint=function(e){Object.keys(o.ControlFlow.SetEnum).forEach((n=>{const r=o.ControlFlow.SetEnum[n],s=e.prototype[r];s&&s.declaration!==t.onlyDeclarationTag||(e.prototype[r]=function(...e){const t=this.valueOf(),n=t[r];let o;return o="function"==typeof n?n.bind(t)(...e):t,(0,i.decide)(o)})})),e.prototype.collectionSet?.declaration!==t.onlyDeclarationTag&&!1!=!!e.prototype.collectionSet||(e.prototype.collectionSet=function(t,...n){const r=e.prototype[t]?.bind(this);return!(!r||"function"!=typeof r)&&r(...n)})},t.MapUint=function(e){Object.keys(o.ControlFlow.MapEnum).forEach((n=>{const r=o.ControlFlow.MapEnum[n],s=e.prototype[r];s&&s.declaration!==t.onlyDeclarationTag||(e.prototype[r]=function(...e){const t=this.valueOf(),n=t[r];let o;return o="function"==typeof n?n.bind(t)(...e):t,(0,i.decide)(o)})})),e.prototype.collectionMap?.declaration!==t.onlyDeclarationTag&&!1!=!!e.prototype.collectionMap||(e.prototype.collectionMap=function(t,...n){const r=e.prototype[t]?.bind(this);return!(!r||"function"!=typeof r)&&r(...n)})}},652:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decide=t.isAbleType=void 0;const r=n(607),o=n(508);let i=null;const s=()=>(null===i&&(i={"[object Object]":o.ObjectTarget,"[object Map]":o.MapObject,"[object Set]":o.SetObject,"[object Array]":o.ArrayObject,"[object Boolean]":o.BooleanObject,"[object Date]":o.DateObject,"[object Number]":o.NumberObject,"[object String]":o.StringObject,"[object ArrayBuffer]":o.DataObject,"[object Uint8Array]":o.DataObject,"[object Promise]":o.ObjectTarget,"[object Null]":o.ObjectTarget,"[object Undefined]":o.ObjectTarget}),i);t.isAbleType=e=>(s(),"[object flow-object]"===Object.prototype.toString.call(e));t.decide=function(e,n=!1){if(s(),(0,t.isAbleType)(e)&&!1===n)return e;const o=Object.prototype.toString.call(e),u=i[o];return u?new u(e??{}):new r.ObjectTarget(e??{})}},398:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkType=void 0,function(e){let t;!function(e){e[e.INIT=0]="INIT",e[e.READY=1]="READY",e[e.RUNNING=2]="RUNNING",e[e.COMPLETE=3]="COMPLETE"}(t=e.WorkRunStatus||(e.WorkRunStatus={}))}(t.WorkType||(t.WorkType={}))},675:(e,t,n)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformSelect=t.isJS=t.isMobile=t.isElectron=t.isPC=t.isNode=t.isWeb=t.currentEnir=t.JSRUNEnvirType=t.getJSEnvironment=t.isReactNative=void 0,function(e){e[e.NODE_PC=10]="NODE_PC",e[e.WEB_PC=20]="WEB_PC",e[e.WEB_MOBILE=26]="WEB_MOBILE",e[e.ELECTRON_PC=40]="ELECTRON_PC",e[e.OTHER=100]="OTHER"}(r||(r={})),t.JSRUNEnvirType=r;const o="win",i="mac",s="linux",u="iOS",a="Android",c="bb",l="winphone",p="other";function d(){if(navigator.userAgent){var e,t,n=navigator.userAgent;const r=()=>{var e=navigator.platform;if(-1!=e.indexOf("Win")){var t=n.match(/Windows NT (\d+).(\d)/i),r="";return"6"==t[1]?1==t[2]?r="7":t[2]>1&&(r="8"):r=t[1],{name:o,versionStr:r}}return-1!=e.indexOf("Mac")?{name:i,versionStr:""}:-1!=e.indexOf("Linux")?{name:s,versionStr:""}:null};if(e=/Windows Phone (?:OS )?([\d.]*)/,t=n.match(e))return{name:l,versionStr:t[1]};if(n.indexOf("(BB10;")>0)return e=/\sVersion\/([\d.]+)\s/,(t=n.match(e))?{name:c,versionStr:t[1]}:{name:c,versionStr:"10"};if(e=/\(([a-zA-Z ]+);\s(?:[U]?[;]?)([\D]+)((?:[\d._]*))(?:.*[\)][^\d]*)([\d.]*)\s/,t=n.match(e)){if(t[0].match(/iPhone|iPad|iPod/))return t[3]=t[3].replace(/_/g,"."),{name:u,versionStr:t[3]};if(t[2].match(/Android/))return t[2]=t[2].replace(/\s/g,""),{name:a,versionStr:t[3]};if(t[0].match(/PlayBook|BlackBerry/))return{name:c,versionStr:t[4]}}return e=/\((Android)[\s]?([\d][.\d]*)?;.*Firefox\/[\d][.\d]*/,(t=n.match(e))?{name:a,versionStr:3==t.length?t[2]:""}:r()}return{name:p,versionStr:""}}var b;if(t.isReactNative=function(){var e;try{e=window}catch(t){e=n.g||globalThis}return e&&e.ReactNative&&e.ReactNative.NativeModules},t.getJSEnvironment=d,t.currentEnir=b,(globalThis||window).process)(globalThis||window)&&(globalThis||window).process&&(globalThis||window).process.versions&&(globalThis||window).process.versions.electron?t.currentEnir=b=r.ELECTRON_PC:t.currentEnir=b=r.NODE_PC;else{switch(d().name){case o:case i:t.currentEnir=b=r.WEB_PC;break;case u:case a:t.currentEnir=b=r.WEB_MOBILE;break;case s:t.currentEnir=b=r.WEB_PC;break;default:t.currentEnir=b=r.OTHER}}const y=b===r.WEB_MOBILE||b===r.WEB_PC;t.isWeb=y;const f=b===r.NODE_PC;t.isNode=f;const g=b===r.ELECTRON_PC;t.isElectron=g;const m=b===r.NODE_PC||b===r.WEB_PC||b===r.ELECTRON_PC;t.isPC=m;const O=b===r.WEB_MOBILE;t.isMobile=O;t.isJS=!0;t.PlatformSelect=e=>{let t;return g?t=e.electron:y?t=e.web:f&&(t=e.node),t}},305:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapperValue=t.unpackValue=void 0;const r=n(607),o=n(652);t.unpackValue=e=>!1==!!e?"":e._value.value.valueOf(),t.wrapperValue=function(e,t){const n=(0,o.decide)(t);return new r.ObjectTarget({...e._value,value:n})}},734:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Base64EnCodeWork=t.Base64DecodeWork=void 0;const r=n(594),o=n(867),i=n(832),s=n(675),u=n(305);class a extends o.InstructionMTM{constructor(){super(...arguments),this.name="Base64EnCodeWork"}run(e){return new i.Observable((t=>{let n;return n=null==e?"":(0,u.unpackValue)(e),t.next((0,u.wrapperValue)(e,r.Base64.encode(n))),t.complete(),{unsubscribe:()=>t.unsubscribe()}}))}static isAble(){return s.isJS}}t.Base64EnCodeWork=a;class c extends o.InstructionMTM{constructor(){super(...arguments),this.name="Base64DecodeWork"}run(e){return new i.Observable((t=>{let n;return n=null==e?"":(0,u.unpackValue)(e),t.next((0,u.wrapperValue)(e,r.Base64.decode(n))),t.complete(),{unsubscribe:()=>t.unsubscribe()}}))}static isAble(){return s.isJS}}t.Base64DecodeWork=c},992:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BeginWork=void 0;const r=n(459),o=n(867),i=n(675),s=n(508),u=n(652);class a extends o.InstructionOTO{constructor(){super(),this.name="BeginWork",this.uuid=(0,r.v4)()}startRun(e,t){const n=t??(0,r.v4)();this.nextWork.next(new s.ObjectTarget({id:n,value:(0,u.decide)(e),option:{}}))}completeOneLoop(){}static isAble(){return i.isJS}}t.BeginWork=a,a._id=0},303:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(867),o=n(832),i=n(675),s=n(607),u=n(597);class a extends r.InstructionOTO{constructor(){super(...arguments),this.name="FetchWork"}_getInitOption(e,t){const n=e.valueOf(),{url:r,method:o,timeout:i,data:s}=n,u={url:r,method:n.method||t.method||"GET",timeout:i||t.timeout||1e4,headers:{...t.headers||{},...n.headers||{}}};return u.data=s,"GET"===o.toLocaleUpperCase()&&(u.headers["Content-Type"]=u.headers["Content-Type"]||"application/json"),u.timeoutErrorMessage="请求超时",u}run(e,t){const n=this,r=this._getInitOption(e._value.value,t);return new o.Observable((t=>{const o=n.context.platform.fetch(r).pipe((0,u.tap)((t=>{const{data:n}=t.valueOf();this.logMsg(`[FetchWork][load:data]${n}`,e)}))).subscribe({next:n=>{const r=n.valueOf();r.error?t.error(r.error):(t.next(new s.ObjectTarget({...e._value,value:r.data})),t.complete())},error:e=>t.error(e),complete:()=>t.complete()});return{unsubscribe:()=>{t.unsubscribe(),o.unsubscribe()}}}))}static isAble(){return i.isJS}}t.default=a},804:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(867),o=n(832),i=n(508),s=n(675),u=n(413),a=n(597),c=n(305);class l extends r.InstructionOTO{constructor(e){super(),this.name="LoadFileWork",this.currentConfig={type:u.FileType.All},this.currentConfig=e||{type:u.FileType.All}}run(e,t){const n=this,r={...t,...this.currentConfig};return new o.Observable((t=>{const o=(0,c.unpackValue)(e),s=n.context.platform.loadFile(o,r).pipe((0,a.tap)((t=>{const{loaded:n,total:r,finish:o}=t.valueOf();this.logMsg(`加载进度[load:progress]---：${n}/${r} 是否完成：${o}`,e)})),(0,a.takeLast)(1)).subscribe({next:n=>{const{data:r,file:o}=n.valueOf();t.next(new i.ObjectTarget({...e._value,value:new i.DataObject(r),option:{file:o}})),t.complete()},complete:()=>t.complete(),error:e=>t.error(e)});return{unsubscribe:()=>{s.unsubscribe(),t.unsubscribe()}}}))}static isAble(){return s.isJS}}t.default=l},545:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(867),o=n(832),i=n(508),s=n(675),u=n(305);class a extends r.InstructionOTO{constructor(){super(...arguments),this.name="OpenURLWork"}run(e,t){const n=this;return new o.Observable((r=>{const o=(0,u.unpackValue)(e),s=n.context.platform.open(o,t).subscribe({next:t=>r.next((0,u.wrapperValue)(e,new i.BooleanObject(!0))),complete:()=>r.complete(),error:e=>r.error(e)});return{unsubscribe:()=>{s.unsubscribe(),r.unsubscribe()}}}))}static isAble(){return s.isJS}}t.default=a},732:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QRCodeWork=void 0;const r=n(867),o=n(832),i=n(675),s=n(305);class u extends r.InstructionOTO{constructor(){super(...arguments),this.name="QRCodeWork"}run(e,t){const n=this;return new o.Observable((r=>{let o;o=null==e?"":(0,s.unpackValue)(e);const i=n.context.platform.createQrCode(o,t).subscribe({next:t=>r.next((0,s.wrapperValue)(e,t)),complete:()=>r.complete(),error:e=>r.error(e)});return{unsubscribe:()=>{i.unsubscribe(),r.unsubscribe()}}}))}static isAble(){return i.isJS}}t.QRCodeWork=u},108:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(867),o=n(832),i=n(675),s=n(305);class u extends r.InstructionOTO{constructor(e="$I$"){super(),this.template="",this.name="RunCommandWork",this.template=e}run(e,t){const n=this;return new o.Observable((r=>{const o=function(e,t,n){const r=n.input;return e.replace(r,t)}(n.template,(0,s.unpackValue)(e),t),i=n.context.platform.runCommand(o).subscribe({next:t=>{this.logMsg(`执行command：${t.error?"失败":"成功"}。结果：${t.result}`,e),r.next((0,s.wrapperValue)(e,t.error?void 0:t.result))},complete:()=>r.complete(),error:e=>r.error(e)});return{unsubscribe:()=>{i.unsubscribe(),r.unsubscribe()}}}))}static isAble(){return i.isJS}}t.default=u},914:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DelayIntervalWork=t.TimeoutWork=t.IntervalWork=void 0;const r=n(832),o=n(597),i=n(607),s=n(305),u=n(867);class a extends u.InstructionOTM{constructor(e,t=1/0,n){super(),this.name="IntervalWork",this.intervalTime=e||1e3,this.maxCount=t,this.notifier=n||r.NEVER}run(e){const t=parseInt((0,s.unpackValue)(e))||this.intervalTime||1e3,n=this;return new r.Observable((u=>{const a=(0,r.interval)(t,r.asyncScheduler).pipe((0,o.take)(n.maxCount),(0,o.takeUntil)(this.notifier)).subscribe({next:t=>u.next((0,s.wrapperValue)(e,new i.NumberObject(t))),error:e=>u.error(e),complete:()=>u.complete()});return{unsubscribe:()=>{u.unsubscribe(),a.unsubscribe()}}}))}}t.IntervalWork=a;class c extends u.InstructionOTO{constructor(e){super(),this.name="TimeoutWork",this.intervalTime=e||1e3}run(e){const t=parseInt((0,s.unpackValue)(e))||this.intervalTime||1e3;return new r.Observable((n=>{const u=(0,r.interval)(t,r.asyncScheduler).pipe((0,o.take)(1)).subscribe({next:t=>{n.next((0,s.wrapperValue)(e,new i.NumberObject(t)))},error:e=>n.error(e),complete:()=>n.complete()});return{unsubscribe:()=>{n.unsubscribe(),u.unsubscribe()}}}))}}t.TimeoutWork=c;class l extends u.InstructionOTM{constructor(e=0,t=1e3,n=1/0,o){super(),this.name="DelayIntervalWork",this.intervalTime=t||1e3,this.maxCount=n,this.delayTime=e||0,this.notifier=o||r.NEVER}run(e){const t=parseInt((0,s.unpackValue)(e))||this.intervalTime||1e3,n=this;return new r.Observable((u=>{const a=(0,r.timer)(n.delayTime,t,r.asyncScheduler).pipe((0,o.take)(n.maxCount),(0,o.takeUntil)(this.notifier)).subscribe({next:t=>u.next((0,s.wrapperValue)(e,new i.NumberObject(t))),error:e=>u.error(e),complete:()=>u.complete()});return{unsubscribe:()=>{u.unsubscribe(),a.unsubscribe()}}}))}}t.DelayIntervalWork=l},867:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstructionMTM=t.InstructionOTM=t.InstructionOTO=t.Instruction=void 0;const r=n(832),o=n(675),i=n(597),s=n(459),u=n(275),a=n(508),c=n(305);class l extends r.Subject{constructor(){super(),this.name="Instruction",this.id=l._id++,this.runSubscriptions=new Map,this.pools=[],this.config={development:!0},this.uuid=(0,s.v4)()}prepare(e,t){return this.beforeWork=e,this.nextWork=t,this.config=this.context.runOptions,this._connectChannel(),Promise.resolve()}_connectChannel(){const e=this,t=this.pipe((0,i.tap)((t=>{this.config?.development&&e.context?.sendLog({work:[e],content:this.context,desc:"[Work:preRun]->接受到数据",value:t})}))).subscribe({complete:()=>{},error:t=>e.error(t),next:t=>e._run(t)});this.pools.push(t)}_run(e){const t=(t,r,o)=>{n.config?.development&&n.context?.sendLog({work:[n],content:this.context,desc:t,value:r||e,error:o})};e=this.nextValue(e)||e;const n=this,a=(this.config?.workConfig||{})[this.name]||{},c=(0,o.PlatformSelect)({web:()=>(n.web_run??n.run).bind(n)(e,a),node:()=>(n.node_run??n.run).bind(n)(e,a),electron:()=>(n.electron_run??n.run).bind(n)(e,a),other:()=>n.run.bind(n)(e,a)});if(t("[Work][Func:run]->入口",e),!0==!c)return t("[Work][Func:run]->没有实现run",e);const l=(0,s.v4)(),p=c(e).pipe((0,i.tap)((e=>t("[Work][Func:run]->结果",e))),(0,i.observeOn)(r.asyncScheduler)).subscribe({complete:()=>{n.runSubscriptions.get(l)?.sub.unsubscribe(),n.runSubscriptions.delete(l)},error:r=>{t("[Work][Func:run]->执行错误",e,r),n.completeOneLoop(e,null,!1)},next:r=>{t("[Work][Func:run]->将执行下一个Work",r),n.completeOneLoop(e,r,!0),n.nextWork?.next(r)}}),d=new u.WorkUnit(n.context,n,p,l);this.runSubscriptions.set(d.uuid,d)}stopWork(){const e=this;return new r.Observable((t=>(e.runSubscriptions.forEach((e=>{e?.sub.unsubscribe()})),t.next(!0),t.complete(),{unsubscribe:()=>t.unsubscribe()})))}clear(){this.pools&&this.pools.forEach((e=>e.unsubscribe())),this.pools.length=0,this.unsubscribe()}error(e){this.context&&this.context.sendLog({work:[this],content:this.context,desc:"[Work:preRun]-接受上一个消息错误",date:new Date,value:new a.StringObject(e.message)})}addVariable(e,t){this.context&&this.context.addVariable(this,e,t)}logMsg(e,t){this.config?.development&&this.context?.sendLog({work:[this],content:this.context,desc:e,value:(0,c.wrapperValue)(t,null)})}next(e){!1===this.closed?super.next(e):this.context.sendLog({work:[this],content:this.context,desc:this.toString()+" 已经关闭",value:(0,c.wrapperValue)(e,null)})}nextValue(e){return e}completeOneLoop(e,t,n){}toString(){return`[${this.name}:${this.id}]`}isAble(){return this.__proto__.isAble()}static isAble(){return o.isJS}}t.Instruction=l,l._id=0;t.InstructionOTO=class extends l{nextValue(e){return e}completeOneLoop(e,t,n){}run(e){return new r.Observable((t=>(t.next(e),t.complete(),{unsubscribe:()=>t.unsubscribe()})))}};t.InstructionOTM=class extends l{constructor(){super(...arguments),this.name="MultipleInstruction"}nextValue(e){return e}completeOneLoop(e,t,n){}run(e){return new r.Observable((t=>(t.next(e),t.complete(),{unsubscribe:()=>t.unsubscribe()})))}};t.InstructionMTM=class extends l{constructor(){super(...arguments),this.name="MultipleInstruction"}nextValue(e){return e}completeOneLoop(e,t,n){}run(e){return new r.Observable((t=>(t.next(e),t.complete(),{unsubscribe:()=>t.unsubscribe()})))}}},275:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkUnit=void 0;const r=n(459);t.WorkUnit=class{constructor(e,t,n,o){this.context=e,this.work=t,this.sub=n,this.uuid=o??(0,r.v4)()}}},607:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decide=t.isAbleType=t.wrapperValue=t.unpackValue=t.FetchWork=t.DelayIntervalWork=t.TimeoutWork=t.IntervalWork=t.RunCommandWork=t.QRCodeWork=t.OpenURLWork=t.LoadFileWork=t.Base64EnCodeWork=t.Base64DecodeWork=t.InstructionOTO=t.InstructionOTM=t.InstructionMTM=t.ControlFlow=t.WorkType=t.Context=t.DataObject=t.DateObject=t.BooleanObject=t.StringObject=t.NumberObject=t.SetObject=t.MapObject=t.ArrayObject=t.ObjectTarget=void 0;const r=n(508);Object.defineProperty(t,"ObjectTarget",{enumerable:!0,get:function(){return r.ObjectTarget}}),Object.defineProperty(t,"ArrayObject",{enumerable:!0,get:function(){return r.ArrayObject}}),Object.defineProperty(t,"MapObject",{enumerable:!0,get:function(){return r.MapObject}}),Object.defineProperty(t,"SetObject",{enumerable:!0,get:function(){return r.SetObject}}),Object.defineProperty(t,"NumberObject",{enumerable:!0,get:function(){return r.NumberObject}}),Object.defineProperty(t,"StringObject",{enumerable:!0,get:function(){return r.StringObject}}),Object.defineProperty(t,"BooleanObject",{enumerable:!0,get:function(){return r.BooleanObject}}),Object.defineProperty(t,"DateObject",{enumerable:!0,get:function(){return r.DateObject}}),Object.defineProperty(t,"DataObject",{enumerable:!0,get:function(){return r.DataObject}});const o=n(398);Object.defineProperty(t,"WorkType",{enumerable:!0,get:function(){return o.WorkType}});const i=n(400);Object.defineProperty(t,"ControlFlow",{enumerable:!0,get:function(){return i.ControlFlow}});const s=n(983);Object.defineProperty(t,"Context",{enumerable:!0,get:function(){return s.Context}});const u=n(867);Object.defineProperty(t,"InstructionMTM",{enumerable:!0,get:function(){return u.InstructionMTM}}),Object.defineProperty(t,"InstructionOTM",{enumerable:!0,get:function(){return u.InstructionOTM}}),Object.defineProperty(t,"InstructionOTO",{enumerable:!0,get:function(){return u.InstructionOTO}});const a=n(734);Object.defineProperty(t,"Base64DecodeWork",{enumerable:!0,get:function(){return a.Base64DecodeWork}}),Object.defineProperty(t,"Base64EnCodeWork",{enumerable:!0,get:function(){return a.Base64EnCodeWork}});const c=n(804);t.LoadFileWork=c.default;const l=n(545);t.OpenURLWork=l.default;const p=n(732);Object.defineProperty(t,"QRCodeWork",{enumerable:!0,get:function(){return p.QRCodeWork}});const d=n(303);t.FetchWork=d.default;const b=n(108);t.RunCommandWork=b.default;const y=n(914);Object.defineProperty(t,"IntervalWork",{enumerable:!0,get:function(){return y.IntervalWork}}),Object.defineProperty(t,"TimeoutWork",{enumerable:!0,get:function(){return y.TimeoutWork}}),Object.defineProperty(t,"DelayIntervalWork",{enumerable:!0,get:function(){return y.DelayIntervalWork}});const f=n(305);Object.defineProperty(t,"unpackValue",{enumerable:!0,get:function(){return f.unpackValue}}),Object.defineProperty(t,"wrapperValue",{enumerable:!0,get:function(){return f.wrapperValue}});const g=n(652);Object.defineProperty(t,"isAbleType",{enumerable:!0,get:function(){return g.isAbleType}}),Object.defineProperty(t,"decide",{enumerable:!0,get:function(){return g.decide}})},300:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__300__},594:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__594__},139:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__139__},832:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__832__},597:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__597__},459:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__459__}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var __webpack_exports__=__webpack_require__(607);return __webpack_exports__})()));