!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("rxjs"),require("qrcode-generator"),require("axios"),require("uuid"),require("rxjs/operators"),require("js-base64"));else if("function"==typeof define&&define.amd)define(["rxjs","qrcode-generator","axios","uuid","rxjs/operators","js-base64"],t);else{var r="object"==typeof exports?t(require("rxjs"),require("qrcode-generator"),require("axios"),require("uuid"),require("rxjs/operators"),require("js-base64")):t(e.rxjs,e["qrcode-generator"],e.axios,e.uuid,e["rxjs/operators"],e["js-base64"]);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(self,((__WEBPACK_EXTERNAL_MODULE__832__,__WEBPACK_EXTERNAL_MODULE__139__,__WEBPACK_EXTERNAL_MODULE__300__,__WEBPACK_EXTERNAL_MODULE__459__,__WEBPACK_EXTERNAL_MODULE__597__,__WEBPACK_EXTERNAL_MODULE__594__)=>(()=>{var __webpack_modules__={413:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SupportContentType=t.FileType=void 0,function(e){e.Audio="audio/*",e.Video="video/*",e.HTML="text/html",e.Txt="text/plain",e.Image="image/*",e.Csv=".csv",e.Pdf="application/pdf",e.Word="application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/msword，application/vnd.openxmlformats-officedocument.wordprocessingml.document",e.All="*"}(t.FileType||(t.FileType={})),function(e){e.JSON="application/json",e.TEXT="text/plain"}(t.SupportContentType||(t.SupportContentType={}))},68:()=>{},558:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(675),o=r(982),s=r(302),c=r(263),i=r(124);r(68);const u=new(0,(0,n.PlatformSelect)({web:{pc:i.PCWebBridge,mobile:c.MobileWebBridge},node:{pc:s.PCNodejsBridge,mobile:o.MobileNodejsBridge},electron:{}})[n.isElectron?"electron":n.isPC?"pc":"mobile"]);t.default=u},206:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlatformBridge=void 0;const rxjs_1=__webpack_require__(832),Object_1=__webpack_require__(108),QRCode=__webpack_require__(139),axios_1=__webpack_require__(300),Hardware_1=__webpack_require__(870);class PlatformBridge extends Hardware_1.HardwareBase{createQrCode(e,t){return new rxjs_1.Observable((r=>{let n=t?.SideLength??200;const o=QRCode(t?.type||4,t?.Level||"H");o.addData(e??""),o.make();const s=(n-4)/o.getModuleCount(),c=o.createDataURL(s,2);return r.next(new Object_1.StringObject(c)),r.complete(),{unsubscribe:()=>r.unsubscribe()}}))}loadRunInfo(){throw new Error("Method not implemented.")}runCommand(command,option){return new rxjs_1.Observable((subscriber=>{let result=null,error=null,status=!1;try{result=eval(command?.toString()),status=!0}catch(e){error=e,status=!1}finally{subscriber.next({result,status,error,command}),subscriber.complete()}return{unsubscribe:()=>subscriber.unsubscribe()}}))}open(e,t){throw new Error("Method not implemented.")}loadFile(e,t){throw new Error("Method not implemented.")}fetch(e){return new rxjs_1.Observable((t=>(axios_1.default.request(e).then((e=>{let r=null,n=null;const o={};200!==e.status?r=new Error(`${e.status} ${e.statusText}`):n=e.data,o.data=n,o.error=r,o.response=e,t.next(new Object_1.ObjectTarget(o)),t.complete()})).catch((e=>{t.error(e)})),{unsubscribe:()=>{t.unsubscribe()}})))}}exports.PlatformBridge=PlatformBridge},870:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HardwareBase=void 0;t.HardwareBase=class{takePhoto(e){throw new Error("Method not implemented.")}recordVideo(e){throw new Error("Method not implemented.")}getPhotos(){throw new Error("Method not implemented.")}getCurrentPosition(){throw new Error("Method not implemented.")}watchPosition(e){throw new Error("Method not implemented.")}closePosition(){throw new Error("Method not implemented.")}recordAudio(){throw new Error("Method not implemented.")}stopAudio(){throw new Error("Method not implemented.")}getFile(e){throw new Error("Method not implemented.")}startVibrator(e){throw new Error("Method not implemented.")}stopVibrator(){throw new Error("Method not implemented.")}getSystemInfo(){throw new Error("Method not implemented.")}getVolume(){throw new Error("Method not implemented.")}setVolume(e){throw new Error("Method not implemented.")}getBrightness(){throw new Error("Method not implemented.")}setBrightness(e){throw new Error("Method not implemented.")}scanBluetooth(){throw new Error("Method not implemented.")}connectBluetooth(e){throw new Error("Method not implemented.")}bluetoothSendData(e){throw new Error("Method not implemented.")}bluetoothReceiveData(e){throw new Error("Method not implemented.")}bluetoothClose(e){throw new Error("Method not implemented.")}speechInit(e){throw new Error("Method not implemented.")}speak(e){throw new Error("Method not implemented.")}stopSpeak(){throw new Error("Method not implemented.")}clearSpeech(){throw new Error("Method not implemented.")}}},982:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileNodejsBridge=void 0;const n=r(832),o=r(108),s=r(206);class c extends s.PlatformBridge{open(e){return(0,n.of)(new o.BooleanObject(!1))}loadFile(e,t){return(0,n.of)(new o.ObjectTarget({total:0,loaded:0,data:new ArrayBuffer(0),finish:!0,file:null}))}}t.MobileNodejsBridge=c},302:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PCNodejsBridge=void 0;const n=r(206);class o extends n.PlatformBridge{}t.PCNodejsBridge=o},263:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileWebBridge=void 0;const n=r(796);class o extends n.WebBridge{}t.MobileWebBridge=o},124:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PCWebBridge=void 0;const n=r(796);class o extends n.WebBridge{}t.PCWebBridge=o},796:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebBridge=void 0;const n=r(832),o=r(108),s=r(206);class c extends s.PlatformBridge{open(e){const t=window.open(e,"__blank");return(0,n.of)(new o.BooleanObject(null!==t))}loadFile(e,t){return new n.Observable((e=>{const r=document.createElement("input");return r.type="file",r.id="_temp_input_select",r.accept=t?.type||"*",r.style.display="none",document.body.append(r),r.addEventListener("change",(t=>{const n=new FileReader,s=r.files[0];n.onprogress=t=>{const{total:r,loaded:c}=t,i=n.result;e.next(new o.ObjectTarget({total:r,loaded:c,data:i,finish:!1,file:s}))},n.onload=t=>{const r=n.result,{total:c,loaded:i}=t;e.next(new o.ObjectTarget({total:c,loaded:i,data:r,finish:!0,file:s})),e.complete()},n.onerror=t=>{e.error(t)},n.readAsArrayBuffer(s)})),r.click(),{unsubscribe:()=>e.unsubscribe()}}))}}t.WebBridge=c},783:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultRunConfig=void 0;const n=r(413);t.DefaultRunConfig={development:!0,environment:{},workConfig:{QRCodeWork:{type:4,Level:"H",SideLength:100},RunCommandWork:{},LoadFileWork:{type:n.FileType.All},FetchWork:{headers:{"Access-Control-Allow-Origin":"*"}}}}},983:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;const n=r(398),o=r(832),s=r(783),c=r(108),i=r(558),u=r(508),a=r(652),l=r(597);t.Context=class{status=n.WorkType.WorkRunStatus.INIT;platform=i.default;runOptions;runConstant=new Map;works=[];msgChannel=new o.Subject;constructor(e){this.runOptions=e||s.DefaultRunConfig;const t=this.msgChannel.subscribe({next:e=>this.workMessage(e),error:e=>this.workError(e)});this.pools.push(t),this.addWork(new u.BeginWork)}pools=[];addVariable(e,t,r){!this.runConstant.get(e.uuid)&&this.runConstant.set(e.uuid,new Map),this.runConstant.get(e.uuid).set(t,r)}workMessage(e){console.log("msgChannel",e)}workError(e){console.log("msgChannelError",e),this.stopWorkChain()}addWorkLog(e){return this.msgChannel.subscribe(e)}sendLog(e){const t={date:new Date,work:e.work.filter((e=>e?.name)),desc:e.desc,value:e.value,error:e.error};this.msgChannel.next(t)}addWork(e){if(e.constructor.isAble&&!1===e.constructor.isAble()){const e="[content][Func:addWork][work isAble is false]";return this.sendLog({content:this,work:[],desc:e,value:null,error:new Error(e)})}if(this.status!==n.WorkType.WorkRunStatus.INIT)return this.sendLog({content:this,work:[],desc:"[content][Func:addWork][context status is not init]",value:new c.BooleanObject(!1)});e.context=this,this.works.push(e)}addWorks(...e){e.forEach(this.addWork)}async prepareWorks(){if(this.status!==n.WorkType.WorkRunStatus.INIT)return this.sendLog({content:this,work:[],desc:"[content][Func:prepareWorks][context status is not init]",value:new c.BooleanObject(!1)});await Promise.all(this.works.map(((e,t,r)=>{const n=r[t-1],o=r[t+1];return e.prepare(n,o)}))),this.status=n.WorkType.WorkRunStatus.READY}dispatch(e){if(this.status===n.WorkType.WorkRunStatus.INIT)return this.sendLog({content:this,work:[],desc:"[context][Func:run][run status is not ready  or 已经初始化]",value:new c.BooleanObject(!1)});const t=this.works[0];t&&t.startRun((0,a.decide)(e)),this.status=n.WorkType.WorkRunStatus.RUNNING}stopWorkChain(){const e=this;return new Promise(((t,r)=>{const n=this.works.map((e=>e.stopWork()));let s=!1,i=[];(0,o.forkJoin)(n).pipe((0,l.take)(1)).subscribe({next:e=>{s=e.every(((e,t)=>!0===e||(i.push(this.works[t]),!1))),t(s)},error:e=>{r(e)},complete:()=>{this.sendLog({content:e,work:i,desc:"[content][Func:stopWorkChain]",value:new c.ObjectTarget({id:"stopWorkChain",value:(0,a.decide)(s),option:{}})})}})}))}clear(){this.pools.forEach((e=>e.unsubscribe()))}}},191:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayObject=void 0;const n=r(347),o=r(652),s=(0,n.createExtendsConstruct)(Array,["length"]);const c=class extends s{constructor(...e){const t=e[0];var r=null;super(r=t instanceof Array&&1===e.length?t:new Array(...e)),this._value=r}len(){return this._value.length}first(){return this._value[0]}last(){return this._value[this._value.length-1]}valueOfIndex(e){return this._value[e]}valueOf(){return this._value}get length(){return(0,o.decide)(this._value.length)}};t.ArrayObject=c},378:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BooleanObject=void 0;const n=r(990);class o extends n.ObjectTarget{static type;constructor(e=!1){super(e),this._value=e}valueOf(){return!!this._value}}t.BooleanObject=o},136:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataObject=void 0;const n=r(990);class o extends n.ObjectTarget{constructor(e=new ArrayBuffer(0)){super(e),this._value=e}data(){return this.valueOf()}valueOf(){return this._value}}t.DataObject=o},400:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DateObject=void 0;const n=r(347),o=r(652),s=(0,n.createExtendsConstruct)(Date);const c=class extends s{constructor(e=new Date){super(e),this._value=e}valueOf(){return this._value}toLocaleString(){return(0,o.decide)(this._value.toLocaleDateString())}timestamp(){return(0,o.decide)(this._value.getDate())}};t.DateObject=c},257:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapObject=void 0;const n=r(347),o=r(652),s=(0,n.createExtendsConstruct)(Map,["size"]);const c=class extends s{valueOf(){return this._value}len(){return this._value.size}get size(){return(0,o.decide)(this._value.size)}};t.MapObject=c},479:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NULLObject=void 0;const n=r(990);class o extends n.ObjectTarget{constructor(e=null){super(e),this._value=e}valueOf(){return this._value}merge(e){return new o(null)}isTruly(){return!!this._value}isNull(){return null===this._value}isUndefined(){return void 0===this._value}}t.NULLObject=o},327:function(e,t,r){"use strict";var n,o=this&&this.__decorate||function(e,t,r,n){var o,s=arguments.length,c=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,n);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(c=(s<3?o(c):s>3?o(t,r,c):o(t,r))||c);return s>3&&c&&Object.defineProperty(t,r,c),c},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.NumberObject=void 0;const c=r(388),i=r(378),u=(0,r(347).createExtendsConstruct)(Number);let a=n=class extends u{static type;constructor(e=1){super(e),this._value=e}valueOf(){return this._value}json(){return super.json()}compare(e,t){return new i.BooleanObject(!1)}more(e){return new i.BooleanObject(this._value>e._value)}equal(e){return new i.BooleanObject(this._value===e._value)}less(e){return new i.BooleanObject(this._value<e._value)}moreEqual(e){return new i.BooleanObject(this._value>=e._value)}lessEqual(e){return new i.BooleanObject(this._value<=e._value)}calc(e,t){return new n(0)}plus(e){return new n(this._value+e._value)}reduce(e){return new n(this._value-e._value)}multi(e){return new n(this._value*e._value)}divide(e){return new n(0===e._value?1/0:this._value/e._value)}};o([c.onlyDeclaration,s("design:type",Function),s("design:paramtypes",[String,Object]),s("design:returntype",i.BooleanObject)],a.prototype,"compare",null),o([c.onlyDeclaration,s("design:type",Function),s("design:paramtypes",[String,Object]),s("design:returntype",a)],a.prototype,"calc",null),a=n=o([c.CalcUnit,c.CompareUnit,s("design:paramtypes",[Number])],a);const l=a;t.NumberObject=l},990:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectTarget=void 0;class n{get[Symbol.toStringTag](){return"flow-object"}constructor(e={}){this._value=e}valueOf(){return this._value}json(){const{StringObject:e}=r(311);try{return new e(JSON.stringify(this._value))}catch(t){return new e("{}")}}}t.ObjectTarget=n},360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetObject=void 0;const n=r(347),o=r(652),s=(0,n.createExtendsConstruct)(Set,["size"]);const c=class extends s{constructor(e){super(),this._value=new Set(e)}len(){return this._value.size}valueOf(){return this._value}get size(){return(0,o.decide)(this._value.size)}};t.SetObject=c},311:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringObject=void 0;const n=r(347),o=r(652),s=(0,n.createExtendsConstruct)(String,["length"]);const c=class extends s{constructor(e){super(),this._value=e}valueOf(){return this._value}get length(){return(0,o.decide)(this._value.length)}};t.StringObject=c},27:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ControlFlow=void 0,function(e){let t,r;!function(e){e.More="more",e.Equal="equal",e.Less="less",e.MoreEqual="moreEqual",e.LessEqual="lessEqual"}(t=e.CompareEnum||(e.CompareEnum={})),function(e){e.Plus="plus",e.Reduce="reduce",e.Multi="multi",e.Divide="divide"}(r=e.CalcEnum||(e.CalcEnum={}))}(t.ControlFlow||(t.ControlFlow={}))},575:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createExtendsInstance=t.createExtendsConstruct=t.NULLObject=t.DataObject=t.DateObject=t.BooleanObject=t.StringObject=t.NumberObject=t.SetObject=t.MapObject=t.ArrayObject=t.ObjectTarget=void 0;const n=r(990);Object.defineProperty(t,"ObjectTarget",{enumerable:!0,get:function(){return n.ObjectTarget}});const o=r(191);Object.defineProperty(t,"ArrayObject",{enumerable:!0,get:function(){return o.ArrayObject}});const s=r(257);Object.defineProperty(t,"MapObject",{enumerable:!0,get:function(){return s.MapObject}});const c=r(360);Object.defineProperty(t,"SetObject",{enumerable:!0,get:function(){return c.SetObject}});const i=r(327);Object.defineProperty(t,"NumberObject",{enumerable:!0,get:function(){return i.NumberObject}});const u=r(311);Object.defineProperty(t,"StringObject",{enumerable:!0,get:function(){return u.StringObject}});const a=r(378);Object.defineProperty(t,"BooleanObject",{enumerable:!0,get:function(){return a.BooleanObject}});const l=r(400);Object.defineProperty(t,"DateObject",{enumerable:!0,get:function(){return l.DateObject}});const d=r(136);Object.defineProperty(t,"DataObject",{enumerable:!0,get:function(){return d.DataObject}});const p=r(479);Object.defineProperty(t,"NULLObject",{enumerable:!0,get:function(){return p.NULLObject}});const b=r(347);Object.defineProperty(t,"createExtendsConstruct",{enumerable:!0,get:function(){return b.createExtendsConstruct}}),Object.defineProperty(t,"createExtendsInstance",{enumerable:!0,get:function(){return b.createExtendsInstance}})},347:function(e,t,r){"use strict";var n=this&&this.__decorate||function(e,t,r,n){var o,s=arguments.length,c=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,n);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(c=(s<3?o(c):s>3?o(t,r,c):o(t,r))||c);return s>3&&c&&Object.defineProperty(t,r,c),c},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.createExtendsInstance=t.createExtendsConstruct=void 0;const s=r(388),c=r(575);var i;function u(e,t=[]){if(i||(i=new Map),i.has(e))return i.get(e);const r={};t=[...t,"constructor","valueOf"],Object.keys(Object.getOwnPropertyDescriptors(e.prototype)).forEach((e=>{t.includes(e)||"symbol"==typeof e||(r[e]=e)}));let u=class extends c.ObjectTarget{constructor(e=null){super(),this._value=e??{}}};return u=n([(0,s.Unit)(r),o("design:paramtypes",[Object])],u),i.set(e,u),u}t.createExtendsConstruct=u,t.createExtendsInstance=function(e,t,r=[]){const n=u(e,r);return Reflect.construct(n,t)}},108:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(22),t),o(r(575),t),o(r(347),t)},22:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},388:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Unit=t.CalcUnit=t.CompareUnit=t.onlyDeclaration=t.onlyDeclarationTag=void 0;const n=r(575),o=r(27),s=r(652);t.onlyDeclarationTag="onlyDeclaration",t.onlyDeclaration=function(e,r,n){n.value.declaration=t.onlyDeclarationTag},t.CompareUnit=function(e){Object.keys(o.ControlFlow.CompareEnum).forEach((r=>{const s=o.ControlFlow.CompareEnum[r],c=e.prototype[s];c&&c.declaration!==t.onlyDeclarationTag||(e.prototype[s]=()=>new n.BooleanObject(!1))})),e.prototype.compare?.declaration!==t.onlyDeclarationTag&&!1!=!!e.prototype.compare||(e.prototype.compare=function(t,r){const n=e.prototype[t]?.bind(this);return!(!n||"function"!=typeof n)&&n.call(this,r)})},t.CalcUnit=function(e){Object.keys(o.ControlFlow.CalcEnum).forEach((r=>{const s=o.ControlFlow.CalcEnum[r],c=e.prototype[s];c&&c.declaration!==t.onlyDeclarationTag||(e.prototype[s]=()=>new n.NumberObject(0))})),e.prototype.calc?.declaration!==t.onlyDeclarationTag&&!1!=!!e.prototype.calc||(e.prototype.calc=function(t,r){const n=e.prototype[t]?.bind(this);return!(!n||"function"!=typeof n)&&n.call(this,r)})},t.Unit=function(e){const r="execFunction";return function(n){Object.keys(e).forEach((r=>{const o=e[r],c=n.prototype[o];c&&c.declaration!==t.onlyDeclarationTag||(n.prototype[o]=function(...e){const t=this.valueOf(),r=t[o];let n;return n="function"==typeof r?r.bind(t)(...e):t,(0,s.decide)(n)})})),n.prototype[r]?.declaration!==t.onlyDeclarationTag&&!1!=!!n.prototype[r]||(n.prototype[r]=function(e,...t){const r=n.prototype[e]?.bind(this);return!(!r||"function"!=typeof r)&&r(...t)})}}},652:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decide=t.isAbleType=void 0;const n=r(575);let o=null;const s=()=>(null===o&&(o={"[object Object]":n.ObjectTarget,"[object Map]":n.MapObject,"[object Set]":n.SetObject,"[object Array]":n.ArrayObject,"[object Boolean]":n.BooleanObject,"[object Date]":n.DateObject,"[object Number]":n.NumberObject,"[object String]":n.StringObject,"[object ArrayBuffer]":n.DataObject,"[object Uint8Array]":n.DataObject,"[object Promise]":n.ObjectTarget,"[object Null]":n.NULLObject,"[object Undefined]":n.NULLObject}),o);t.isAbleType=e=>(s(),"[object flow-object]"===Object.prototype.toString.call(e)),t.decide=function(e,r=!1){if(s(),(0,t.isAbleType)(e)&&!1===r)return e;const c=Object.prototype.toString.call(e),i=o[c];return i?new i(e??{}):new n.ObjectTarget(e)}},398:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkType=void 0,function(e){let t;!function(e){e[e.INIT=0]="INIT",e[e.READY=1]="READY",e[e.RUNNING=2]="RUNNING",e[e.COMPLETE=3]="COMPLETE"}(t=e.WorkRunStatus||(e.WorkRunStatus={}))}(t.WorkType||(t.WorkType={}))},675:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformSelect=t.isJS=t.isMobile=t.isElectron=t.isPC=t.isNode=t.isWeb=t.currentEnir=t.JSRUNEnvirType=t.getJSEnvironment=t.isReactNative=void 0,function(e){e[e.NODE_PC=10]="NODE_PC",e[e.WEB_PC=20]="WEB_PC",e[e.WEB_MOBILE=26]="WEB_MOBILE",e[e.ELECTRON_PC=40]="ELECTRON_PC",e[e.OTHER=100]="OTHER"}(n||(n={})),t.JSRUNEnvirType=n;const o="win",s="mac",c="linux",i="iOS",u="Android",a="bb",l="winphone",d="other";function p(){if(navigator.userAgent){var e,t,r=navigator.userAgent;const n=()=>{var e=navigator.platform;if(-1!=e.indexOf("Win")){var t=r.match(/Windows NT (\d+).(\d)/i),n="";return"6"==t[1]?1==t[2]?n="7":t[2]>1&&(n="8"):n=t[1],{name:o,versionStr:n}}return-1!=e.indexOf("Mac")?{name:s,versionStr:""}:-1!=e.indexOf("Linux")?{name:c,versionStr:""}:null};if(e=/Windows Phone (?:OS )?([\d.]*)/,t=r.match(e))return{name:l,versionStr:t[1]};if(r.indexOf("(BB10;")>0)return e=/\sVersion\/([\d.]+)\s/,(t=r.match(e))?{name:a,versionStr:t[1]}:{name:a,versionStr:"10"};if(e=/\(([a-zA-Z ]+);\s(?:[U]?[;]?)([\D]+)((?:[\d._]*))(?:.*[\)][^\d]*)([\d.]*)\s/,t=r.match(e)){if(t[0].match(/iPhone|iPad|iPod/))return t[3]=t[3].replace(/_/g,"."),{name:i,versionStr:t[3]};if(t[2].match(/Android/))return t[2]=t[2].replace(/\s/g,""),{name:u,versionStr:t[3]};if(t[0].match(/PlayBook|BlackBerry/))return{name:a,versionStr:t[4]}}return e=/\((Android)[\s]?([\d][.\d]*)?;.*Firefox\/[\d][.\d]*/,(t=r.match(e))?{name:u,versionStr:3==t.length?t[2]:""}:n()}return{name:d,versionStr:""}}var b;if(t.isReactNative=function(){var e;try{e=window}catch(t){e=r.g||globalThis}return e&&e.ReactNative&&e.ReactNative.NativeModules},t.getJSEnvironment=p,t.currentEnir=b,(globalThis||window).process)(globalThis||window)&&(globalThis||window).process&&(globalThis||window).process.versions&&(globalThis||window).process.versions.electron?t.currentEnir=b=n.ELECTRON_PC:t.currentEnir=b=n.NODE_PC;else{switch(p().name){case o:case s:t.currentEnir=b=n.WEB_PC;break;case i:case u:t.currentEnir=b=n.WEB_MOBILE;break;case c:t.currentEnir=b=n.WEB_PC;break;default:t.currentEnir=b=n.OTHER}}const _=b===n.WEB_MOBILE||b===n.WEB_PC;t.isWeb=_;const f=b===n.NODE_PC;t.isNode=f;const O=b===n.ELECTRON_PC;t.isElectron=O;const m=b===n.NODE_PC||b===n.WEB_PC||b===n.ELECTRON_PC;t.isPC=m;const h=b===n.WEB_MOBILE;t.isMobile=h;t.isJS=!0;t.PlatformSelect=e=>{let t;return O?t=e.electron:_?t=e.web:f&&(t=e.node),t}},305:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapperValue=t.unpackValue=void 0;const n=r(607),o=r(652);t.unpackValue=function(e){return!1==!!e?"":e._value.value.valueOf()},t.wrapperValue=function(e,t){const r=(0,o.decide)(t);return new n.ObjectTarget({...e._value,value:r})}},69:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.noop=void 0;t.noop=function(){}},734:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Base64EnCodeWork=t.Base64DecodeWork=void 0;const n=r(594),o=r(867),s=r(832),c=r(675),i=r(305);class u extends o.InstructionMTM{name="Base64EnCodeWork";run(e){return new s.Observable((t=>{let r;return r=null==e?"":(0,i.unpackValue)(e),t.next((0,i.wrapperValue)(e,n.Base64.encode(r))),t.complete(),{unsubscribe:()=>t.unsubscribe()}}))}static isAble(){return c.isJS}}t.Base64EnCodeWork=u;class a extends o.InstructionMTM{name="Base64DecodeWork";run(e){return new s.Observable((t=>{let r;return r=null==e?"":(0,i.unpackValue)(e),t.next((0,i.wrapperValue)(e,n.Base64.decode(r))),t.complete(),{unsubscribe:()=>t.unsubscribe()}}))}static isAble(){return c.isJS}}t.Base64DecodeWork=a},508:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BeginWork=void 0;const n=r(459),o=r(867),s=r(675),c=r(108),i=r(652);class u extends o.InstructionOTO{static OPTION;name="BeginWork";static _id=0;inputSubscription;constructor(){super(),this.uuid=(0,n.v4)()}startRun(e,t){const r=t??(0,n.v4)();this.nextWork.next(new c.ObjectTarget({id:r,value:(0,i.decide)(e),option:{}}))}completeOneLoop(){}static isAble(){return s.isJS}}t.BeginWork=u},303:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(867),o=r(832),s=r(675),c=r(607),i=r(597);class u extends n.InstructionOTO{name="FetchWork";_getInitOption(e,t){const r=e.valueOf(),{url:n,method:o,timeout:s,data:c}=r,i={url:n,method:r.method||t.method||"GET",timeout:s||t.timeout||1e4,headers:{...t.headers||{},...r.headers||{}}};return i.data=c,"GET"===o.toLocaleUpperCase()&&(i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json"),i.timeoutErrorMessage="请求超时",i}run(e,t){const r=this,n=this._getInitOption(e._value.value,t);return new o.Observable((t=>{const o=r.context.platform.fetch(n).pipe((0,i.tap)((t=>{const{data:r}=t.valueOf();this.logMsg(`[FetchWork][load:data]${r}`,e)}))).subscribe({next:r=>{const n=r.valueOf();n.error?t.error(n.error):(t.next(new c.ObjectTarget({...e._value,value:n.data})),t.complete())},error:e=>t.error(e),complete:()=>t.complete()});return{unsubscribe:()=>{t.unsubscribe(),o.unsubscribe()}}}))}static isAble(){return s.isJS}}t.default=u},804:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(867),o=r(832),s=r(108),c=r(675),i=r(413),u=r(597),a=r(305);class l extends n.InstructionOTO{name="LoadFileWork";currentConfig={type:i.FileType.All};constructor(e){super(),this.currentConfig=e||{type:i.FileType.All}}run(e,t){const r=this,n={...t,...this.currentConfig};return new o.Observable((t=>{const o=(0,a.unpackValue)(e),c=r.context.platform.loadFile(o,n).pipe((0,u.tap)((t=>{const{loaded:r,total:n,finish:o}=t.valueOf();this.logMsg(`加载进度[load:progress]---：${r}/${n} 是否完成：${o}`,e)})),(0,u.takeLast)(1)).subscribe({next:r=>{const{data:n,file:o}=r.valueOf();t.next(new s.ObjectTarget({...e._value,value:new s.DataObject(n),option:{file:o}})),t.complete()},complete:()=>t.complete(),error:e=>t.error(e)});return{unsubscribe:()=>{c.unsubscribe(),t.unsubscribe()}}}))}static isAble(){return c.isJS}}t.default=l},545:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(867),o=r(832),s=r(108),c=r(675),i=r(305);class u extends n.InstructionOTO{name="OpenURLWork";run(e,t){const r=this;return new o.Observable((n=>{const o=(0,i.unpackValue)(e),c=r.context.platform.open(o,t).subscribe({next:t=>n.next((0,i.wrapperValue)(e,new s.BooleanObject(!0))),complete:()=>n.complete(),error:e=>n.error(e)});return{unsubscribe:()=>{c.unsubscribe(),n.unsubscribe()}}}))}static isAble(){return c.isJS}}t.default=u},732:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QRCodeWork=void 0;const n=r(867),o=r(832),s=r(675),c=r(305);class i extends n.InstructionOTO{name="QRCodeWork";run(e,t){const r=this;return new o.Observable((n=>{let o;o=null==e?"":(0,c.unpackValue)(e);const s=r.context.platform.createQrCode(o,t).subscribe({next:t=>n.next((0,c.wrapperValue)(e,t._value)),complete:()=>n.complete(),error:e=>n.error(e)});return{unsubscribe:()=>{s.unsubscribe(),n.unsubscribe()}}}))}static isAble(){return s.isJS}}t.QRCodeWork=i},627:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(867),o=r(832),s=r(675),c=r(305);class i extends n.InstructionOTO{template="";name="RunCommandWork";paramsConfig={};callBack=null;constructor(...e){if(super(),"string"==typeof e[0]){const t=e[0]||"$I$",r=e[1]||{"*":"$I$"};this.template=t,this.paramsConfig=r}else"function"==typeof e[0]&&(this.callBack=e[0])}run(e,t){const r=this;return new o.Observable((n=>{let o;o=r.callBack&&"function"==typeof r.callBack?this.callBack((0,c.unpackValue)(e),t):function(e,t,r,n){const o=(0,c.unpackValue)(t);let s=e;if("string"==typeof o){const e=r["*"];e&&(s=s.replaceAll(e,o))}else Object.keys(r).forEach((e=>{const t=r[e],n=o[e];s=s.replaceAll(t,n)}));return s}(r.template,e,this.paramsConfig);const s=r.context.platform.runCommand(o).subscribe({next:t=>{this.logMsg(`执行command：${t.error?"失败":"成功"}。结果：${t.result}`,e),n.next((0,c.wrapperValue)(e,!!(t.error?void 0:t.result)))},complete:()=>n.complete(),error:e=>n.error(e)});return{unsubscribe:()=>{s.unsubscribe(),n.unsubscribe()}}}))}static isAble(){return s.isJS}}t.default=i},914:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DelayIntervalWork=t.TimeoutWork=t.IntervalWork=void 0;const n=r(832),o=r(597),s=r(108),c=r(305),i=r(867);class u extends i.InstructionOTM{name="IntervalWork";intervalTime;maxCount;notifier;constructor(e,t=1/0,r){super(),this.intervalTime=e||1e3,this.maxCount=t,this.notifier=r||n.NEVER}run(e){const t=parseInt((0,c.unpackValue)(e))||this.intervalTime||1e3,r=this;return new n.Observable((s=>{const i=(0,n.interval)(t,n.asyncScheduler).pipe((0,o.take)(r.maxCount),(0,o.takeUntil)(this.notifier)).subscribe({next:t=>s.next((0,c.wrapperValue)(e,t)),error:e=>s.error(e),complete:()=>s.complete()});return{unsubscribe:()=>{s.unsubscribe(),i.unsubscribe()}}}))}}t.IntervalWork=u;class a extends i.InstructionOTO{name="TimeoutWork";intervalTime;constructor(e){super(),this.intervalTime=e||1e3}run(e){const t=parseInt((0,c.unpackValue)(e))||this.intervalTime||1e3;return new n.Observable((r=>{const s=(0,n.interval)(t,n.asyncScheduler).pipe((0,o.take)(1)).subscribe({next:t=>{r.next((0,c.wrapperValue)(e,t))},error:e=>r.error(e),complete:()=>r.complete()});return{unsubscribe:()=>{r.unsubscribe(),s.unsubscribe()}}}))}}t.TimeoutWork=a;class l extends i.InstructionOTM{name="DelayIntervalWork";intervalTime;maxCount;delayTime;notifier;constructor(e=0,t=1e3,r=1/0,o){super(),this.intervalTime=t||1e3,this.maxCount=r,this.delayTime=e||0,this.notifier=o||n.NEVER}run(e){const t=parseInt((0,c.unpackValue)(e))||this.intervalTime||1e3,r=this;return new n.Observable((i=>{const u=(0,n.timer)(r.delayTime,t,n.asyncScheduler).pipe((0,o.take)(r.maxCount),(0,o.takeUntil)(this.notifier)).subscribe({next:t=>i.next((0,c.wrapperValue)(e,new s.NumberObject(t))),error:e=>i.error(e),complete:()=>i.complete()});return{unsubscribe:()=>{i.unsubscribe(),u.unsubscribe()}}}))}}t.DelayIntervalWork=l},867:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstructionMTM=t.InstructionOTM=t.InstructionOTO=t.Instruction=void 0;const n=r(832),o=r(675),s=r(597),c=r(459),i=r(275),u=r(108),a=r(305),l=r(69);class d extends n.Subject{name="Instruction";static _id=0;id=d._id++;uuid;beforeWork;nextWork;context;runSubscriptions=new Map;pools=[];config={development:!0};constructor(){super(),this.uuid=(0,c.v4)()}prepare(e,t){return this.beforeWork=e,this.nextWork=t,this.config=this.context?.runOptions||{},this._connectChannel(),Promise.resolve()}_connectChannel(){const e=this,t=this.pipe((0,s.tap)((t=>{this.config?.development&&e.context?.sendLog({work:[e],content:this.context,desc:"[Work:preRun]->接受到数据",value:t})}))).subscribe({complete:()=>{},error:t=>e.error(t),next:t=>e._run(t)});this.pools.push(t)}_run(e){const t=(t,n,o)=>{r.config?.development&&r.context?.sendLog({work:[r],content:this.context,desc:t,value:n||e,error:o})};e=this.nextValue(e)||e;const r=this,u=(this.config?.workConfig||{})[this.name]||{},a=(0,o.PlatformSelect)({web:()=>(r.web_run??(r.run||l.noop)).bind(r)(e,u),node:()=>(r.node_run??(r.run||l.noop)).bind(r)(e,u),electron:()=>(r.electron_run??(r.run||l.noop)).bind(r)(e,u),other:()=>(r.run||l.noop).bind(r)(e,u)});t("[Work][Func:run]->入口",e);const d=(0,c.v4)(),p=a(e).pipe((0,s.tap)((function(e){t("[Work][Func:run]->结果",e)})),(0,s.observeOn)(n.asyncScheduler)).subscribe({complete:()=>{r.runSubscriptions.get(d)?.sub.unsubscribe(),r.runSubscriptions.delete(d)},error:n=>{t("[Work][Func:run]->执行错误",e,n),r.completeOneLoop(e,null,!1)},next:n=>{t("[Work][Func:run]->将执行下一个Work",n),r.completeOneLoop(e,n,!0),r.nextWork?.next(n)}}),b=new i.WorkUnit(r.context,r,p,d);this.runSubscriptions.set(b.uuid,b)}stopWork(){const e=this;return new n.Observable((t=>(e.runSubscriptions.forEach((e=>{e?.sub.unsubscribe()})),t.next(!0),t.complete(),{unsubscribe:()=>t.unsubscribe()})))}clear(){this.pools&&this.pools.forEach((e=>e.unsubscribe())),this.pools.length=0,this.unsubscribe()}error(e){this.context&&this.context.sendLog({work:[this],content:this.context,desc:"[Work:preRun]-接受上一个消息错误",date:new Date,value:new u.StringObject(e.message)})}addVariable(e,t){this.context&&this.context.addVariable(this,e,t)}logMsg(e,t){this.config?.development&&this.context?.sendLog({work:[this],content:this.context,desc:e,value:(0,a.wrapperValue)(t,null)})}next(e){!1===this.closed?super.next(e):this.context.sendLog({work:[this],content:this.context,desc:this.toString()+" 已经关闭",value:(0,a.wrapperValue)(e,null)})}nextValue(e){return e}completeOneLoop(e,t,r){}toString(){return`[${this.name}:${this.id}]`}isAble(){return this.__proto__.isAble()}static isAble(){return o.isJS}}t.Instruction=d;t.InstructionOTO=class extends d{nextValue(e){return e}completeOneLoop(e,t,r){}run(e){return new n.Observable((t=>(t.next(e),t.complete(),{unsubscribe:()=>t.unsubscribe()})))}};t.InstructionOTM=class extends d{static OPTION;name="MultipleInstruction";nextValue(e){return e}completeOneLoop(e,t,r){}run(e){return new n.Observable((t=>(t.next(e),t.complete(),{unsubscribe:()=>t.unsubscribe()})))}};t.InstructionMTM=class extends d{static OPTION;name="MultipleInstruction";nextValue(e){return e}completeOneLoop(e,t,r){}run(e){return new n.Observable((t=>(t.next(e),t.complete(),{unsubscribe:()=>t.unsubscribe()})))}}},275:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkUnit=void 0;const n=r(459);t.WorkUnit=class{context;work;uuid;sub;constructor(e,t,r,o){this.context=e,this.work=t,this.sub=r,this.uuid=o??(0,n.v4)()}}},607:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createExtendsInstance=t.createExtendsConstruct=t.decide=t.isAbleType=t.wrapperValue=t.unpackValue=t.FetchWork=t.DelayIntervalWork=t.TimeoutWork=t.IntervalWork=t.RunCommandWork=t.QRCodeWork=t.OpenURLWork=t.LoadFileWork=t.Base64EnCodeWork=t.Base64DecodeWork=t.InstructionOTO=t.InstructionOTM=t.InstructionMTM=t.ControlFlow=t.WorkType=t.Context=t.NULLObject=t.DataObject=t.DateObject=t.BooleanObject=t.StringObject=t.NumberObject=t.SetObject=t.MapObject=t.ArrayObject=t.ObjectTarget=void 0;const n=r(108);Object.defineProperty(t,"ObjectTarget",{enumerable:!0,get:function(){return n.ObjectTarget}}),Object.defineProperty(t,"ArrayObject",{enumerable:!0,get:function(){return n.ArrayObject}}),Object.defineProperty(t,"MapObject",{enumerable:!0,get:function(){return n.MapObject}}),Object.defineProperty(t,"SetObject",{enumerable:!0,get:function(){return n.SetObject}}),Object.defineProperty(t,"NumberObject",{enumerable:!0,get:function(){return n.NumberObject}}),Object.defineProperty(t,"StringObject",{enumerable:!0,get:function(){return n.StringObject}}),Object.defineProperty(t,"BooleanObject",{enumerable:!0,get:function(){return n.BooleanObject}}),Object.defineProperty(t,"DateObject",{enumerable:!0,get:function(){return n.DateObject}}),Object.defineProperty(t,"DataObject",{enumerable:!0,get:function(){return n.DataObject}}),Object.defineProperty(t,"NULLObject",{enumerable:!0,get:function(){return n.NULLObject}}),Object.defineProperty(t,"createExtendsConstruct",{enumerable:!0,get:function(){return n.createExtendsConstruct}}),Object.defineProperty(t,"createExtendsInstance",{enumerable:!0,get:function(){return n.createExtendsInstance}});const o=r(398);Object.defineProperty(t,"WorkType",{enumerable:!0,get:function(){return o.WorkType}});const s=r(27);Object.defineProperty(t,"ControlFlow",{enumerable:!0,get:function(){return s.ControlFlow}});const c=r(983);Object.defineProperty(t,"Context",{enumerable:!0,get:function(){return c.Context}});const i=r(867);Object.defineProperty(t,"InstructionMTM",{enumerable:!0,get:function(){return i.InstructionMTM}}),Object.defineProperty(t,"InstructionOTM",{enumerable:!0,get:function(){return i.InstructionOTM}}),Object.defineProperty(t,"InstructionOTO",{enumerable:!0,get:function(){return i.InstructionOTO}});const u=r(734);Object.defineProperty(t,"Base64DecodeWork",{enumerable:!0,get:function(){return u.Base64DecodeWork}}),Object.defineProperty(t,"Base64EnCodeWork",{enumerable:!0,get:function(){return u.Base64EnCodeWork}});const a=r(804);t.LoadFileWork=a.default;const l=r(545);t.OpenURLWork=l.default;const d=r(732);Object.defineProperty(t,"QRCodeWork",{enumerable:!0,get:function(){return d.QRCodeWork}});const p=r(303);t.FetchWork=p.default;const b=r(627);t.RunCommandWork=b.default;const _=r(914);Object.defineProperty(t,"IntervalWork",{enumerable:!0,get:function(){return _.IntervalWork}}),Object.defineProperty(t,"TimeoutWork",{enumerable:!0,get:function(){return _.TimeoutWork}}),Object.defineProperty(t,"DelayIntervalWork",{enumerable:!0,get:function(){return _.DelayIntervalWork}});const f=r(305);Object.defineProperty(t,"unpackValue",{enumerable:!0,get:function(){return f.unpackValue}}),Object.defineProperty(t,"wrapperValue",{enumerable:!0,get:function(){return f.wrapperValue}});const O=r(652);Object.defineProperty(t,"isAbleType",{enumerable:!0,get:function(){return O.isAbleType}}),Object.defineProperty(t,"decide",{enumerable:!0,get:function(){return O.decide}})},300:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__300__},594:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__594__},139:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__139__},832:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__832__},597:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__597__},459:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__459__}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var __webpack_exports__=__webpack_require__(607);return __webpack_exports__})()));